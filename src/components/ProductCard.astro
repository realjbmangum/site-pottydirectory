---
import siteConfig from '../data/site-config.json';

interface Product {
  id: string;
  name: string;
  description: string;
  priceRange: string;
  asin: string;
  category: string;
}

interface Props {
  product: Product;
  variant?: 'default' | 'compact' | 'horizontal';
}

const { product, variant = 'default' } = Astro.props;
const amazonTag = siteConfig.monetization?.amazonTag || '';
const affiliateUrl = `https://www.amazon.com/dp/${product.asin}?tag=${amazonTag}`;
---

{variant === 'default' && (
  <a
    href={affiliateUrl}
    target="_blank"
    rel="noopener noreferrer sponsored"
    class="block bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-lg hover:border-amber-300 transition-all duration-200 overflow-hidden h-full"
  >
    <div class="p-5 flex flex-col h-full">
      <h3 class="font-semibold text-gray-900 mb-2 line-clamp-2">{product.name}</h3>
      <p class="text-sm text-gray-600 mb-4 line-clamp-3 flex-grow">{product.description}</p>
      <div class="flex items-center justify-between mt-auto pt-3 border-t border-gray-100">
        <span class="text-lg font-bold text-gray-900">{product.priceRange}</span>
        <span class="inline-flex items-center bg-gradient-to-r from-amber-400 to-orange-500 text-white px-3 py-1.5 rounded-lg text-sm font-medium">
          View on Amazon
        </span>
      </div>
    </div>
  </a>
)}

{variant === 'compact' && (
  <a
    href={affiliateUrl}
    target="_blank"
    rel="noopener noreferrer sponsored"
    class="block bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md hover:border-amber-300 transition-all duration-200"
  >
    <h4 class="font-medium text-gray-900 text-sm line-clamp-1 mb-1">{product.name}</h4>
    <p class="text-xs text-gray-500 line-clamp-2 mb-2">{product.description}</p>
    <div class="flex items-center justify-between">
      <span class="text-sm font-bold text-gray-900">{product.priceRange}</span>
      <span class="text-xs font-medium text-amber-600">
        Amazon &rarr;
      </span>
    </div>
  </a>
)}

{variant === 'horizontal' && (
  <a
    href={affiliateUrl}
    target="_blank"
    rel="noopener noreferrer sponsored"
    class="block bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-lg hover:border-amber-300 transition-all duration-200 overflow-hidden"
  >
    <div class="p-5">
      <h3 class="font-semibold text-gray-900 mb-2">{product.name}</h3>
      <p class="text-sm text-gray-600 mb-3">{product.description}</p>
      <div class="flex items-center justify-between">
        <span class="text-lg font-bold text-gray-900">{product.priceRange}</span>
        <span class="inline-flex items-center bg-gradient-to-r from-amber-400 to-orange-500 text-white px-4 py-2 rounded-lg text-sm font-medium">
          View on Amazon
        </span>
      </div>
    </div>
  </a>
)}
